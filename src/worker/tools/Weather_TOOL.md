# ğŸ¤– AI Agent è‡ªä¸»å·¥å…·è°ƒç”¨ç³»ç»ŸæŒ‡å—

## ç³»ç»Ÿæ¦‚è¿°

æˆ‘ä»¬å·²å°†å¤©æ°”æŸ¥è¯¢åŠŸèƒ½å‡çº§ä¸º**AI è‡ªä¸»å†³ç­–çš„å·¥å…·è°ƒç”¨ç³»ç»Ÿ**ã€‚ç°åœ¨ AI Agent èƒ½å¤Ÿï¼š

- ğŸ§  **è‡ªä¸»åˆ†æ**ç”¨æˆ·æ„å›¾
- ğŸ“‹ **æ™ºèƒ½è§„åˆ’**æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·
- ğŸ› ï¸ **è‡ªåŠ¨é€‰æ‹©**åˆé€‚çš„å·¥å…·
- ğŸ”„ **å¤šæ­¥æ¨ç†**å®Œæˆå¤æ‚ä»»åŠ¡

## æ ¸å¿ƒæ”¹è¿›

### 1. ç§»é™¤äº†ç¡¬ç¼–ç è§„åˆ™

- âŒ ä¸å†ä½¿ç”¨å…³é”®è¯åŒ¹é…
- âœ… AI è‡ªä¸»ç†è§£ç”¨æˆ·æ„å›¾
- âœ… åŸºäºä¸Šä¸‹æ–‡æ™ºèƒ½å†³ç­–

### 2. å¢å¼ºäº†ç³»ç»Ÿæç¤º

- ğŸ“š æä¾›å·¥å…·ä½¿ç”¨æŒ‡å—
- ğŸ¯ æ˜ç¡®å·¥å…·é€‚ç”¨åœºæ™¯
- ğŸ’¡ æŒ‡å¯¼ AI å†³ç­–æµç¨‹

### 3. ä¼˜åŒ–äº†å·¥å…·æ¶æ„

- ğŸ”§ æ”¯æŒå¤šå·¥å…·ååŒå·¥ä½œ
- ğŸ“ˆ å¯æ‰©å±•çš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿ
- ğŸ›ï¸ çµæ´»çš„å·¥å…·è°ƒç”¨ç­–ç•¥

## å·¥ä½œåŸç†

### AI å†³ç­–æµç¨‹

```
ç”¨æˆ·è¾“å…¥
    â†“
AIåˆ†ææ„å›¾
    â†“
æ˜¯å¦éœ€è¦å·¥å…·ï¼Ÿ â†’ å¦ â†’ ç›´æ¥å›ç­”
    â†“ æ˜¯
é€‰æ‹©åˆé€‚å·¥å…·
    â†“
æ‰§è¡Œå·¥å…·è°ƒç”¨
    â†“
åŸºäºç»“æœå›ç­”
```

### ç³»ç»Ÿæç¤ºè®¾è®¡

```typescript
const systemMessage = {
  role: 'system',
  content: `ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½AIåŠ©æ‰‹ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ¥å¸®åŠ©ç”¨æˆ·ã€‚

å¯ç”¨å·¥å…·ï¼š
1. getWeather - æŸ¥è¯¢å•ä¸ªåŸå¸‚çš„å½“å‰å¤©æ°”æƒ…å†µ
2. getMultipleCitiesWeather - åŒæ—¶æŸ¥è¯¢å¤šä¸ªåŸå¸‚çš„å¤©æ°”æƒ…å†µ

å·¥å…·ä½¿ç”¨æŒ‡å—ï¼š
- å½“ç”¨æˆ·è¯¢é—®å¤©æ°”ç›¸å…³ä¿¡æ¯æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ç›¸åº”çš„å¤©æ°”å·¥å…·
- å¯¹äºå•ä¸ªåŸå¸‚å¤©æ°”æŸ¥è¯¢ï¼Œä½¿ç”¨getWeatherå·¥å…·
- å¯¹äºå¤šä¸ªåŸå¸‚å¤©æ°”æŸ¥è¯¢ï¼Œä½¿ç”¨getMultipleCitiesWeatherå·¥å…·
- å¦‚æœç”¨æˆ·çš„é—®é¢˜ä¸æ¶‰åŠå¤©æ°”ï¼Œåˆ™æ­£å¸¸å›ç­”ï¼Œä¸è¦ä½¿ç”¨å·¥å…·
- å·¥å…·è°ƒç”¨åï¼ŒåŸºäºå·¥å…·è¿”å›çš„ç»“æœæ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜

è¯·æ ¹æ®ç”¨æˆ·çš„å…·ä½“éœ€æ±‚æ™ºèƒ½åˆ¤æ–­æ˜¯å¦éœ€è¦ä½¿ç”¨å·¥å…·ï¼Œä»¥åŠä½¿ç”¨å“ªä¸ªå·¥å…·ã€‚`,
};
```

## ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1ï¼šAI è‡ªä¸»å†³å®šè°ƒç”¨å·¥å…·

**ç”¨æˆ·**: "ä»Šå¤©åŒ—äº¬çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"

**AI æ€è€ƒè¿‡ç¨‹**:

1. åˆ†æï¼šç”¨æˆ·è¯¢é—®å¤©æ°”ä¿¡æ¯ âœ“
2. åˆ¤æ–­ï¼šå•ä¸ªåŸå¸‚æŸ¥è¯¢ âœ“
3. å†³ç­–ï¼šä½¿ç”¨ getWeather å·¥å…·
4. æ‰§è¡Œï¼šè°ƒç”¨å·¥å…·å¹¶è¿”å›ç»“æœ

**å“åº”**:

```
è®©æˆ‘ä¸ºæ‚¨æŸ¥è¯¢åŒ—äº¬çš„å¤©æ°”æƒ…å†µ...

åŒ—äº¬çš„å¤©æ°”æƒ…å†µï¼š
ğŸŒ¡ï¸ æ¸©åº¦ï¼š22.5Â°C
â˜ï¸ å¤©æ°”ï¼šæ™´æœ—
ğŸ’§ æ¹¿åº¦ï¼š65%
ğŸ’¨ é£é€Ÿï¼š3.2 m/s
ğŸ•’ æŸ¥è¯¢æ—¶é—´ï¼š2025/12/30 14:04:29
```

### åœºæ™¯ 2ï¼šAI å†³å®šä¸è°ƒç”¨å·¥å…·

**ç”¨æˆ·**: "å¸®æˆ‘å†™ä¸€ä¸ª JavaScript å‡½æ•°"

**AI æ€è€ƒè¿‡ç¨‹**:

1. åˆ†æï¼šç”¨æˆ·è¯·æ±‚ä»£ç ç¼–å†™ âœ—
2. åˆ¤æ–­ï¼šä¸æ¶‰åŠå¤©æ°”æŸ¥è¯¢
3. å†³ç­–ï¼šç›´æ¥å›ç­”ï¼Œä¸ä½¿ç”¨å·¥å…·

**å“åº”**:

```
å½“ç„¶å¯ä»¥ï¼è¯·å‘Šè¯‰æˆ‘æ‚¨éœ€è¦ä»€ä¹ˆåŠŸèƒ½çš„JavaScriptå‡½æ•°ï¼Œæˆ‘ä¼šä¸ºæ‚¨ç¼–å†™ã€‚
```

### åœºæ™¯ 3ï¼šå¤æ‚æŸ¥è¯¢å¤„ç†

**ç”¨æˆ·**: "æ¯”è¾ƒä¸€ä¸‹åŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·çš„å¤©æ°”"

**AI æ€è€ƒè¿‡ç¨‹**:

1. åˆ†æï¼šç”¨æˆ·è¯¢é—®å¤šä¸ªåŸå¸‚å¤©æ°” âœ“
2. åˆ¤æ–­ï¼šå¤šåŸå¸‚æŸ¥è¯¢ âœ“
3. å†³ç­–ï¼šä½¿ç”¨ getMultipleCitiesWeather å·¥å…·
4. æ‰§è¡Œï¼šæ‰¹é‡æŸ¥è¯¢å¹¶æ¯”è¾ƒç»“æœ

**å“åº”**:

```
è®©æˆ‘ä¸ºæ‚¨æŸ¥è¯¢è¿™ä¸‰ä¸ªåŸå¸‚çš„å¤©æ°”æƒ…å†µ...

å¤šä¸ªåŸå¸‚çš„å¤©æ°”æƒ…å†µï¼š

1. åŒ—äº¬ï¼š
   ğŸŒ¡ï¸ 22.5Â°Cï¼Œæ™´æœ—
   ğŸ’§ æ¹¿åº¦65%ï¼ŒğŸ’¨ é£é€Ÿ3.2m/s

2. ä¸Šæµ·ï¼š
   ğŸŒ¡ï¸ 25.8Â°Cï¼Œå¤šäº‘
   ğŸ’§ æ¹¿åº¦72%ï¼ŒğŸ’¨ é£é€Ÿ2.8m/s

3. å¹¿å·ï¼š
   ğŸŒ¡ï¸ 28.3Â°Cï¼Œé›·é˜µé›¨
   ğŸ’§ æ¹¿åº¦78%ï¼ŒğŸ’¨ é£é€Ÿ4.1m/s

ğŸ•’ æŸ¥è¯¢æ—¶é—´ï¼š2025/12/30 14:04:29
```

## æŠ€æœ¯å®ç°

### åç«¯æ¶æ„

```typescript
// å·¥å…·é…ç½®
export const weatherTool = {
  type: 'function' as const,
  function: {
    name: 'getWeather',
    description: 'æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”æƒ…å†µ',
    parameters: {
      type: 'object' as const,
      required: ['city'],
      properties: {
        city: {
          type: 'string' as const,
          description: 'è¦æŸ¥è¯¢å¤©æ°”çš„åŸå¸‚åç§°',
        },
      },
    },
  },
};

// AIè‡ªä¸»å†³ç­–æ¥å£
app.post('/api/agent/chat-with-tools', async (c) => {
  const { messages } = await c.req.json();

  // æ·»åŠ ç³»ç»Ÿæç¤ºæŒ‡å¯¼AIå†³ç­–
  const systemMessage = {
    role: 'system',
    content: `ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½AIåŠ©æ‰‹ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ¥å¸®åŠ©ç”¨æˆ·...`,
  };

  const result = await generateText({
    model: getModel('gemini-2.5-flash'),
    messages: [systemMessage, ...messages],
    tools: availableTools,
    maxSteps: 3,
  });

  // å¤„ç†å·¥å…·è°ƒç”¨ç»“æœ
  if (result.toolCalls && result.toolCalls.length > 0) {
    // æ‰§è¡Œå·¥å…·å¹¶è¿”å›ç»“æœ
  }
});
```

### å‰ç«¯é›†æˆ

```typescript
// ç®€åŒ–å‰ç«¯é€»è¾‘ï¼Œè®©AIè‡ªä¸»å†³ç­–
const handleSubmit = async () => {
  // ... å‡†å¤‡æ¶ˆæ¯

  // ç›´æ¥ä½¿ç”¨å·¥å…·è°ƒç”¨æ¨¡å¼
  await handleToolsMode(userMessage.content);
};

// å·¥å…·è°ƒç”¨å¤„ç†
const handleToolsMode = async (content: string) => {
  const response = await fetch('/api/agent/chat-with-tools', {
    method: 'POST',
    body: JSON.stringify({ messages: conversation }),
  });

  const data = await response.json();

  // å¤„ç†AIå†³ç­–ç»“æœ
  if (data.hasTools) {
    // AIå†³å®šä½¿ç”¨å·¥å…·
    displayToolResults(data.toolResults);
  } else {
    // AIå†³å®šç›´æ¥å›ç­”
    displayNormalResponse(data.message);
  }
};
```

## ä¼˜åŠ¿ç‰¹ç‚¹

### 1. æ™ºèƒ½å†³ç­–

- ğŸ¯ å‡†ç¡®ç†è§£ç”¨æˆ·æ„å›¾
- ğŸ§  åŸºäºä¸Šä¸‹æ–‡çš„å†³ç­–
- ğŸ“Š å­¦ä¹ ä¼˜åŒ–å†³ç­–ç­–ç•¥

### 2. çµæ´»æ‰©å±•

- ğŸ”§ æ˜“äºæ·»åŠ æ–°å·¥å…·
- ğŸ“¦ æ¨¡å—åŒ–å·¥å…·è®¾è®¡
- ğŸ”„ å·¥å…·ç»„åˆä½¿ç”¨

### 3. ç”¨æˆ·ä½“éªŒ

- âš¡ å“åº”æ›´è‡ªç„¶
- ğŸ¨ äº¤äº’æ›´æ™ºèƒ½
- ğŸ“± ç•Œé¢æ›´å‹å¥½

## æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°å·¥å…·

1. **å®šä¹‰å·¥å…·**

```typescript
export const newTool = {
  type: 'function' as const,
  function: {
    name: 'toolName',
    description: 'å·¥å…·æè¿°',
    parameters: {
      type: 'object' as const,
      required: ['param1'],
      properties: {
        param1: { type: 'string', description: 'å‚æ•°æè¿°' },
      },
    },
  },
};
```

2. **å®ç°æ‰§è¡Œå‡½æ•°**

```typescript
async function executeNewTool(name: string, args: any) {
  if (name === 'toolName') {
    // æ‰§è¡Œå·¥å…·é€»è¾‘
    return result;
  }
}
```

3. **æ³¨å†Œå·¥å…·**

```typescript
export const availableTools = [weatherTool, newTool];
```

4. **æ›´æ–°ç³»ç»Ÿæç¤º**

```typescript
const systemMessage = {
  role: 'system',
  content: `å¯ç”¨å·¥å…·ï¼š
1. getWeather - å¤©æ°”æŸ¥è¯¢
2. toolName - æ–°å·¥å…·åŠŸèƒ½
...`,
};
```

## æœ€ä½³å®è·µ

### 1. å·¥å…·è®¾è®¡åŸåˆ™

- ğŸ¯ å•ä¸€èŒè´£ï¼šæ¯ä¸ªå·¥å…·åªåšä¸€ä»¶äº‹
- ğŸ“ ç®€æ´æ¥å£ï¼šå‚æ•°ç®€å•æ˜äº†
- ğŸ”’ é”™è¯¯å¤„ç†ï¼šå®Œå–„çš„é”™è¯¯æœºåˆ¶

### 2. ç³»ç»Ÿæç¤ºä¼˜åŒ–

- ğŸ“š æ¸…æ™°è¯´æ˜ï¼šå·¥å…·åŠŸèƒ½å’Œä½¿ç”¨åœºæ™¯
- ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹ï¼šæä¾›å…·ä½“è°ƒç”¨ç¤ºä¾‹
- âš ï¸ æ³¨æ„äº‹é¡¹ï¼šè¯´æ˜é™åˆ¶å’Œè¾¹ç•Œæ¡ä»¶

### 3. æ€§èƒ½è€ƒè™‘

- âš¡ å·¥å…·æ‰§è¡Œæ•ˆç‡
- ğŸ”„ å¹¶å‘å¤„ç†èƒ½åŠ›
- ğŸ“ˆ èµ„æºä½¿ç”¨ä¼˜åŒ–

## æœªæ¥å±•æœ›

### è®¡åˆ’åŠŸèƒ½

- ğŸ¤– å¤š Agent åä½œ
- ğŸ”— å·¥å…·é“¾å¼è°ƒç”¨
- ğŸ“Š å†³ç­–è¿‡ç¨‹å¯è§†åŒ–
- ğŸ“ è‡ªä¸»å­¦ä¹ ä¼˜åŒ–

### æŠ€æœ¯æ¼”è¿›

- ğŸ” æ›´ç²¾å‡†çš„æ„å›¾è¯†åˆ«
- ğŸ¯ æ›´æ™ºèƒ½çš„å·¥å…·é€‰æ‹©
- ğŸ”„ æ›´çµæ´»çš„å·¥ä½œæµ
- ğŸŒ æ›´å¹¿æ³›çš„å·¥å…·ç”Ÿæ€

---

è¿™ä¸ªç³»ç»Ÿå±•ç¤ºäº†ç°ä»£ AI Agent çš„æ ¸å¿ƒèƒ½åŠ›ï¼š**è‡ªä¸»å†³ç­–ã€æ™ºèƒ½è§„åˆ’ã€å·¥å…·ä½¿ç”¨**ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒAI èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£ç”¨æˆ·éœ€æ±‚ï¼Œå¹¶æä¾›æ›´å‡†ç¡®ã€æ›´æœ‰ç”¨çš„å¸®åŠ©ã€‚
